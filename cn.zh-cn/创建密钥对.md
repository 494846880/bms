# 创建密钥对<a name="bms_01_0015"></a>

## 操作场景<a name="section4261155401719"></a>

为安全起见，裸金属服务器登录时建议使用密钥方式进行身份验证。因此，您需要使用已有密钥对或新建一个密钥对，用于远程登录身份验证。

-   新建密钥对

    如果没有可用的密钥对，需要新建一个密钥对，生成公钥和私钥，并在登录裸金属服务器时进行鉴权。创建密钥对的方法如下：

    -   通过管理控制台创建密钥对，公钥自动保存在系统中，私钥由用户保存在本地，具体操作请参见[通过管理控制台创建密钥对](#section177941342144514)。
    -   通过puttygen.exe工具创建密钥对，公钥和私钥均保存在用户本地，具体操作请参见[通过puttygen.exe工具创建密钥对](#section1553115399576)。

-   使用已有密钥对

    如果本地已有密钥对，可以直接选择管理控制台的“导入密钥对 \> 选择文件”导入密钥，具体操作请参见[导入密钥对](#section139515511165)。


## 约束与限制<a name="section73191236174210"></a>

-   当前支持的加解密算法为：
    -   SSH-2（RSA，1024）
    -   SSH-2（RSA，2048）
    -   SSH-2（RSA，4096）

-   私钥是保证您的裸金属服务器安全的重要手段之一，用于SSH登录身份认证，为保证裸金属服务器安全，只能下载一次，请妥善保管。

## 通过管理控制台创建密钥对<a name="section177941342144514"></a>

1.  登录管理控制台。
2.  单击管理控制台左上角的![](figures/icon-region.png)，选择地域和项目。
3.  选择“计算 \> 裸金属服务器”。
4.  在左侧导航树中，选择“密钥对”。
5.  在“密钥对”页面，单击“创建密钥对”。
6.  输入密钥名称。
7.  单击“确定”。
8.  在系统弹出的提示框中单击“确定”。

    请根据提示信息，查看并保存私钥。为保证安全，私钥只能下载一次，请妥善保管。


## 通过puttygen.exe工具创建密钥对<a name="section1553115399576"></a>

1.  生成公钥和私钥文件。
    1.  双击“PUTTYGEN.EXE”，打开“PuTTY Key Generator”。

        **图 1**  PuTTY Key Generator<a name="fig59544198014"></a>  
        ![](figures/PuTTY-Key-Generator.png "PuTTY-Key-Generator")

    2.  单击“Generate”。

        密钥生成器将自动生成一对公钥和私钥，其中，[图2](#fig178446172216)的红框内容为生成的公钥文件。

        **图 2**  生成公钥和私钥文件<a name="fig178446172216"></a>  
        ![](figures/生成公钥和私钥文件.png "生成公钥和私钥文件")


2.  复制红框中的公钥内容，并将其粘贴在文本文档中，以.txt格式保存在本地，保存公钥文件。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >请勿直接单击“Save public key”保存公钥文件。因为通过puttygen.exe工具的“Save public key”按钮保存在本地的公钥文件，公钥内容的格式会发生变化，不能直接导入管理控制台使用。  

3.  保存私钥文件。

    根据不同用途，需将私钥文件保存为不同格式。为保证安全，私钥只能下载一次，请妥善保管。

    -   保存私钥文件为“.ppk”格式。

        当用户使用PuTTY工具登录Linux裸金属服务器时，需使用“.ppk”格式的私钥文件。保存方法如下：

        1.  在“PuTTY Key Generator”界面，选择“File \> Save private key”。
        2.  保存私钥到本地。例如：kp-123.ppk。

    -   保存私钥文件为“.pem”格式。

        当用户使用Xshell工具登录Linux裸金属服务器时，或者获取Windows裸金属服务器的密码时，需使用“.pem”格式的私钥文件。保存方法如下：

        1.  在“PuTTY Key Generator”界面，选择“Conversions \> Export Open SSH key”。

            >![](public_sys-resources/icon-notice.gif) **注意：**   
            >如果该私钥文件用于Windows裸金属服务器的获取密码操作，在选择“Export OpenSSH key”时，请勿填写“Key passphrase”信息，否则会导致获取密码失败。  

        2.  保存私钥到本地。例如：kp-123.pem。


4.  公钥和私钥文件按照需要正确保存后，请参见“复制公钥文件内容方式”，将公钥导入系统中。

## 导入密钥对<a name="section139515511165"></a>

通过puttygen.exe工具的“Save public key”按钮保存在本地的公钥文件，公钥内容的格式会发生变化，不能直接导入管理控制台。请先参考[通过puttygen.exe工具创建的密钥对，导入管理控制台失败怎么办？](通过puttygen-exe工具创建的密钥对-导入管理控制台失败怎么办.md)，获取正确格式的公钥文件内容，然后再导入管理控制台。

1.  登录管理控制台。
2.  选择“计算 \> 裸金属服务器”。
3.  在左侧导航树中，选择“密钥对”。
4.  在“密钥对”页面，单击“导入密钥对”。

    **图 3**  导入密钥对<a name="fig9255913185714"></a>  
    ![](figures/导入密钥对.png "导入密钥对")

5.  导入密钥对的方式有如下两种：
    -   选择文件方式：将本地已有的可用密钥，导入到系统中。
        1.  在管理控制台“导入密钥对”页面，单击“选择文件”，选择本地保存的公钥文件。

            >![](public_sys-resources/icon-note.gif) **说明：**   
            >执行“导入密钥对”操作时，请确认导入的是公钥文件，否则会导入失败。  

        2.  单击“确定”，导入公钥。

            公钥导入成功后，您可以修改公钥名称。


    -   复制公钥文件内容方式：将“.txt”格式文本文档中的公钥内容粘贴至对话框，导入到系统中。
        1.  复制文本文档中保存的公钥文件内容，并将其粘贴在“公钥内容”的空白区域。
        2.  单击“确定”，导入公钥。



